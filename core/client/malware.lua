local infectedStrings = {
    "cb",
    "qb",
    "QB",
    "esx",
    "ESX",
    "var",
    "Var",
    "run",
    "Run",
    "Lua",
    "xml",
    "esx",
    "cfg",
    "exe",
    "temp",
    "exit",
    "snip",
    ".cfg",
    "Temp",
    "stop",
    "Stop",
    "fake",
    "Fake",
    "help",
    "Help",
    "code",
    "Code",
    "json",
    "menu",
    "Menu",
    "lynx",
    "Lynx",
    "dll",
    "eulen",
    "Eulen",
    "hydro",
    "Hydro",
    "fivem",
    "FiveM",
    ".xml",
    ".dll",
    ".json",
    ".exe",
    "inject",
    "Inject",
    "canary",
    "Canary",
    "tempVar",
    "extreme",
    "Extreme",
    "TempVar",
    "execute",
    "Execute",
    "stopper",
    "Stopper",
    "LuaCode",
    "Injector",
    "Injector",
    "Executor",
    "Executor",
    "helpCode",
    "HelpCode",
    "fileName",
    "FileName",
    "resource",
    "Resource",
    "TriggerEvent",
    "TriggerClientEvent",
    "StopResource",
    "callback",
    "ServerCallback",
    "RegisterServerEvent",
    "onResourceStop",
    "onClientResourceStop",
    "onResourceStarting",
    "onResourceStart",
    "onClientResourceStart"
}

-- Make sure all files are added
local files = {
    "fxmanifest.lua",
    "config_cl.lua",
    "core/client/transmitter.lua",
    "modules/client/injection.lua",
    "modules/client/aimbot.lua",
    "modules/client/devtools.lua",
    "modules/client/godmode.lua",
    "modules/client/natives.lua",
    "modules/client/noclip.lua",
    "modules/client/ped_blacklist.lua",
    "modules/client/spectate.lua",
    "modules/client/speed.lua",
    "modules/client/weapon_ammo.lua",
    "modules/client/weapon_blacklist.lua",
    "modules/client/weapon_modifier.lua",
    "modules/client/weapon_explosive_bullet.lua"
}

Citizen.CreateThread(function()
    local mFile = LoadResourceFile(GetCurrentResourceName(), "core/client/malware.lua")
    local mSize = tonumber(#mFile)
	while true do
        Citizen.Wait(15000)
        local file = LoadResourceFile(GetCurrentResourceName(), "core/client/malware.lua")
        local size = tonumber(#file)
        if size > mSize then
            	TriggerServerEvent("anticheat:flagAsCheater", "Injected Code", false)
            	return
        end
	end
end)

Citizen.CreateThread(function()
	while true do
	    Citizen.Wait(15000)
        local rName = GetCurrentResourceName()
		for i=1, #files do
			local rFile = LoadResourceFile(rName, files[i])
			if rFile ~= nil then
				for x=1, #infectedStrings do
					local str = infectedStrings[x]
					if string.find(rFile, str) then
						TriggerServerEvent("anticheat:flagAsCheater", "Infected String [" .. str .. ", " .. files[i] .. "]", false)
                        			return
					end
				end
			end
		end
	end
end)